<script src='../src/compression/LZWuncompress.js'></script>

<script>

function test0() {
  console.log('__________ binary works test__________')
  window.fu = new LZWuncompress()
  var orig = [1,2,3,254]
  var bin = fu.inputToBinary(orig)
  var int8 = fu.binaryToUint8(bin)
  console.assert( arraysEqual(orig, int8) ,'binary test' , orig, 'should ===' , int8)
}

function test1a() {
  console.log('__________ test1a compress/decompress test __________')
  fu = new LZWuncompress()
  var orig = [0,0,0,1,2,3,5,8,65,65,1,2,3]
  var a = fu.compress(orig)
  console.log('compressed')
  fu = new LZWuncompress()
  var b = fu.decompress(a)
  console.log('decompressed')
  console.assert( arraysEqual(orig, b), 'compress test', orig, 'should ===' , b)
}


function test1b() {
  console.log('__________ test1b bigger compress/decompress test __________')
  fu = new LZWuncompress()
  var orig = fillArray(new Uint8Array(2046))
  console.log(orig)
  var a = fu.compress(orig)
  console.log('compressed')
  var b = fu.decompress(a)
  console.log('decompressed')
  console.assert( arraysEqual(orig, b), 'compress test', orig, 'should ===' , b)
}

function test1c() {
  console.log('__________ test1c much bigger compress/decompress test __________')
  fu = new LZWuncompress()
  var orig = block
  var a = fu.compress(orig)
  console.log('compressed')
  var b = fu.decompress(a)
  console.log('decompressed')
  console.assert( arraysEqual(orig, b), 'compress test', orig, 'should ===' , b)
}

function test1d() {
  console.log('__________ test1d float64 compress/decompress test __________')
  fu = new LZWuncompress()
  var orig = fillArray(new Float64Array(4000))
  console.log(orig)
  var view = new Uint8Array(orig.buffer)
  var a = fu.compress(view)
  console.log('compressed')
  var b = fu.decompress(a)
  var b2 = new Uint8Array(b)
  var view2 = new Float64Array(b2.buffer)
  console.log('decompressed')
  console.assert( arraysEqual(orig, view2), 'compress test', orig, 'should ===' , b)
}


function test2() {
  console.log('_______________ test 2 decompress block made by gdal ___________________')
  fu = new LZWuncompress()
  var dc = fu.decompress(block)
  console.log(dc)
}


function arraysEqual(arr1, arr2) {
    if(arr1.length !== arr2.length)
        return false;
    for(var i = arr1.length; i--;) {
        if(arr1[i] !== arr2[i])
            return false;
    }

    return true;
}

function fillArray(ar) {
  for (var i=0; i<ar.length; i++) {
    ar[i] = i
    if (i>500 && i < 700) ar[i] = 0
    if (i>900 && i < 1000) ar[i] = 0
  }
  return ar
}

var block = [128,63,223,231,248,20,14,11,4,129,66,32,208,152,60,54,25,15,133,196,97,81,56,116,74,43,20,136,70,34,209,152,188,118,57,31,141,200,99,82,56,244,138,75,36,144,74,36,210,153,60,182,89,47,149,204,101,83,57,116,202,107,52,152,78,38,211,153,188,245,100,175,0,143,39,244,26,29,10,129,70,162,81,232,180,186,85,54,147,79,164,84,105,149,10,157,74,157,86,170,85,234,181,186,213,118,179,95,172,88,107,150,11,29,138,189,102,178,89,236,182,186,186,100,144,172,32,91,174,22,203,77,214,209,119,178,220,136,21,91,213,234,233,120,181,96,110,215,252,38,11,1,131,195,97,113,24,188,62,55,21,142,196,228,113,152,252,166,75,33,65,191,101,178,185,60,54,102,161,125,183,222,243,90,60,230,151,47,167,205,234,52,154,173,54,167,93,171,215,235,118,27,59,6,123,89,183,216,143,52,23,61,166,227,123,185,224,111,248,91,46,38,251,139,193,227,240,248,214,29,183,35,151,206,232,114,186,60,158,167,63,165,215,234,244,250,221,158,199,111,189,218,240,119,124,61,207,39,127,197,231,242,248,252,222,159,71,175,150,54,106,134,52,89,141,15,171,237,237,251,251,63,94,239,207,243,240,255,186,175,131,229,1,8,16,35,251,3,192,15,243,247,4,65,112,76,25,5,66,15,84,13,7,66,144,108,45,8,194,176,196,47,7,195,144,203,31,9,195,112,244,69,16,196,144,212,77,14,196,177,68,79,17,197,113,76,89,21,70,17,124,101,23,70,145,52,64,168,198,241,140,107,29,69,177,236,121,31,198,113,242,175,2,72,143,140,11,35,72,175,148,129,29,200,50,92,133,38,74,18,124,164,178,201,50,60,7,35,73,210,204,155,45,202,50,212,187,46,59,210,172,115,48,75,210,156,201,51,203,243,76,204,226,204,82,196,135,55,77,83,44,229,52,77,115,172,231,53,74,170,172,199,56,206,147,188,237,62,208,19,228,241,36,78,19,253,5,67,81,19,245,21,64,209,44,52,219,37,81,148,93,15,73,54,238,109,35,22,81,239,156,123,76,211,148,45,41,79,210,244,157,67,70,170,20,236,175,72,66,245,52,173,85,207,117,37,93,80,84,85,141,94,203,70,244,203,251,85,79,53,29,97,89,214,83,43,119,77,87,245,252,85,92,80,149,61,87,15,216,180,213,137,99,87,118,109,117,103,196,182,18,143,96,180,54,148,163,101,213,150,77,176,212,213,182,229,147,103,87,182,133,120,211,182,214,162,225,75,63,118,234,143,108,93,150,213,191,76,83,215,21,193,113,222,107,205,171,123,220,247,197,53,91,221,214,53,219,127,95,182,205,152,179,221,75,181,109,121,97,23,14,21,114,62,171,109,245,107,78,183,254,5,137,213,77,206,11,28,94,56,93,235,132,222,142,85,208,221,97,182,190,3,139,168,182,219,219,92,227,88,230,55,148,188,183,50,227,125,101,120,198,1,129,180,216,190,73,149,103,25,102,58,198,101,216,134,75,128,185,217,67,221,131,168,58,32,121,161,104,217,142,149,156,231,108,110,33,159,81,217,30,165,153,223,121,62,129,55,230,153,150,39,165,231,90,230,155,164,178,218,134,13,169,226,151,125,101,155,106,250,238,153,175,102,59,69,81,144,55,155,84,107,138,237,123,174,228,230,102,27,182,181,177,105,176,126,233,187,237,155,210,139,143,210,154,22,127,183,145,71,105,104,32,113,60,95,27,173,240,90,142,169,195,114,60,7,43,190,181,124,122,203,205,114,246,71,39,140,243,28,183,69,208,189,220,127,57,209,239,219,79,73,192,230,187,55,87,105,228,61,127,80,238,226,93,103,100,187,239,253,191,109,221,214,155,38,111,217,248,11,13,107,208,119,158,15,109,183,89,94,39,59,229,232,187,39,139,221,121,154,212,245,66,247,254,135,141,201,121,59,127,159,93,242,158,15,115,234,251,122,103,193,232,240,190,167,205,207,235,63,15,175,245,250,223,110,45,243,236,186,207,187,247,124,159,175,217,245,104,254,87,155,237,93,125,6,192,253,223,179,237,127,239,209,157,62,53,74,235,156,59,85,128,16,45,87,63,52,168,234,160,75,248,121,238,230,9,64,20,37,2,32,180,25,93,46,250,8,65,168,8,105,224,115,253,127,141,142,17,193,248,42,128,96,227,233,131,207,226,1,190,248,74,234,97,124,43,72,48,82,25,58,56,66,254,223,140,10,132,208,213,41,67,119,243,10,160,99,109,117,80,208,176,67,228,253,17,144,75,38,136,45,98,29,66,117,198,210,33,76,58,138,17,1,225,63,166,35,21,142,211,243,137,80,238,37,189,232,163,1,147,12,24,80,112,196,242,189,248,163,19,158,60,29,80,238,214,17,68,215,176,95,227,4,48,141,208,161,244,67,152,145,23,96,20,98,129,177,125,231,28,168,167,29,162,195,122,139,112,182,30,68,120,206,163,24,148,132,135,16,13,163,68,72,184,123,227,236,120,144,205,190,63,199,24,147,31,35,170,173,145,81,85,170,61,57,59,33,94,196,142,141,11,194,58,189,201,49,28,218,212,162,119,178,126,73,59,73,15,43,101,132,97,140,146,165,215,71,120,126,246,101,66,222,147,50,6,88,199,8,213,35,229,27,103,143,82,122,41,75,200,65,41,224,124,179,133,147,14,80,75,215,196,252,32,188,187,149,146,222,75,76,233,173,48,30,139,195,153,70,246,109,67,152,19,45,166,12,216,154,243,134,104,200,8,169,57,38,108,226,157,73,149,228,72,153,153,56,231,76,232,77,147,26,118,75,89,141,59,166,148,185,158,51,238,120,64,121,207,34,37,123,184,148,243,118,106,206,185,249,65,162,43,240,160,179,126,119,208,41,167,67,37,44,109,159,19,153,99,208,121,229,66,12,108,155,152,147,130,85,204,89,243,47,167,204,91,162,244,142,116,208,74,27,4,104,148,244,163,178,168,198,81,57,27,74,167,237,24,164,145,210,138,198,90,6,255,169,57,171,164,207,202,152,83,42,45,79,231,245,20,162,18,226,151,77,4,193,31,233,157,62,166,45,6,95,212,90,67,78,85,77,80,169,85,78,164,212,202,31,19,42,115,144,169,117,2,170,65,234,89,53,41,189,17,171,117,142,174,205,121,29,68,232,221,82,170,181,114,181,204,42,196,244,170,196,145,161,213,106,178,215,90,219,70,36,212,86,172,245,134,154,215,106,217,95,216,92,90,170,82,218,164,70,218,239,97,236,3,164,163,149,6,144,75,138,81,89,44,69,144,99,150,21,18,210,43,19,100,107,243,119,155,177,202,197,217,155,61,103,108,196,229,152,136,242,70,83,219,67,41,40,165,59,159,85,186,190,196,234,23,78,171,229,167,178,86,206,197,86,171,97,9,108,180,99,181,118,122,164,217,74,167,70,172,189,193,172,150,130,108,219,107,105,108,173,229,194,150,147,110,227,220,171,145,115,238,116,220,180,215,70,230,221,91,147,117,174,69,175,187,23,82,235,221,219,161,26,238,157,219,188,87,122,238,93,251,200,220,239,13,231,189,87,154,246,94,91,221,120,231,13,218,138,247,50,245,222,251,235,112,238,53,247,191,87,182,248,95,104,229,127,47,221,254,192,87,247,2,96,28,11,128,35,77,244,193,24,15,3,96,220,23,129,240,102,15,193,216,69,81,223,44,37,133,240,163,34,173,245,223,11,97,156,39,96,107,148,46,177,216,123,12,97,10,163,85,241,54,31,197,83,46,127,226,151,171,135,113,78,37,150,86,239,25,99,92,72,229,241,133,191,189,56,219,24,227,124,123,143,241,94,62,200,57,3,30,100,60,141,145,114,70,66,201,57,19,37,100,216,109,126,103,172,148,199,121,59,35,220,92,90,237,241,206,75,202,175,178,205,204,252,165,130,178,166,90,107,215,19,38,100,252,193,153,103,86,93,196,25,95,25,101,156,195,31,178,157,45,206,55,207,26,85,204,221,154,31,46,108,148,57,206,255,216,108,223,158,44,156,191,204,89,91,58,232,12,215,93,46,6,102,208,183,235,59,229,188,233,86,113,102,139,208,122,27,71,215,205,27,164,244,118,69,171,58,95,63,233,156,61,166,234,53,154,207,154,119,76,90,42,83,83,242,190,156,58,164,4]

test0()
test1a()
test1b()
test1c()
test1d()
test2()
</script>
<body>



</body>
